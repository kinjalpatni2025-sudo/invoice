<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Merge Multiple PDFs — Smarttool Hub</title>
<meta name="description" content="Merge multiple PDFs securely in your browser. Reorder pages, skip corrupt files, and download a single merged PDF."/>
<link rel="icon" type="image/png" href="https://img.icons8.com/fluency/48/toolbox.png"/>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>

<style>
  :root{
    --bg:#121826;--card:#1e293b;--muted:#94a3b8;--text:#fff;
    --pri1:#6366f1;--pri2:#0ea5e9;--accent:#22c55e;--warn:#ef4444
  }
  *{box-sizing:border-box}
  body{font-family:Arial, sans-serif;background:var(--bg);color:var(--text);margin:0}
  /* Header (matched to landing) */
  header{background:linear-gradient(90deg,var(--pri1),var(--pri2));padding:15px 20px;
    display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;
    box-shadow:0 4px 12px rgba(0,0,0,0.4);position:sticky;top:0;z-index:1000}
  header .logo{display:flex;align-items:center;gap:10px;text-decoration:none;color:#fff}
  header .logo img{width:40px;height:40px;border-radius:8px}
  header h1{margin:0;font-size:1.35rem}
  header .tagline{color:#e0f2fe;font-size:0.9rem;margin-top:2px;font-style:italic}
  header a.home{color:#fff;text-decoration:none;font-weight:bold;opacity:.9}
  header a.home:hover{opacity:1;text-decoration:underline}
  /* Layout */
  .container{max-width:1100px;margin:20px auto;padding:18px}
  .card{background:var(--card);border-radius:12px;padding:18px;box-shadow:0 4px 12px rgba(0,0,0,.35)}
  .title{display:flex;align-items:center;gap:10px;margin:0 0 10px}
  .subtitle{color:var(--muted);margin:0 0 16px}
  /* Uploader */
  .actions{display:flex;flex-wrap:wrap;gap:12px;align-items:center;margin-bottom:14px}
  .btn{display:inline-flex;align-items:center;gap:8px;border:none;cursor:pointer;padding:10px 14px;
       border-radius:10px;background:var(--pri1);color:#fff;font-weight:600}
  .btn.secondary{background:#0b1220;border:1px solid #334155}
  .btn.danger{background:var(--warn)}
  .btn:disabled{opacity:.6;cursor:not-allowed}
  label.btn{cursor:pointer}
  #fileInput{display:none}
  .hint{font-size:12px;color:var(--muted)}
  /* Drop zone */
  .drop{border:2px dashed var(--pri2);border-radius:12px;padding:28px;text-align:center;margin:12px 0;
        transition:.2s background, .2s border-color}
  .drop.drag{border-color:#fff;background:#0b1220}
  /* File list */
  .list{margin-top:10px;display:grid;gap:8px}
  .item{display:flex;align-items:center;justify-content:space-between;background:#0f172a;
        border:1px solid #334155;border-radius:10px;padding:10px 12px}
  .name{display:flex;align-items:center;gap:10px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:70%}
  .controls{display:flex;align-items:center;gap:8px}
  .iconbtn{background:#111827;border:1px solid #334155;border-radius:8px;padding:8px;cursor:pointer;color:#e5e7eb}
  .iconbtn:hover{background:#1f2937}
  /* Progress */
  .progress{display:none;margin-top:14px}
  .bar{height:10px;background:#0b1220;border:1px solid #334155;border-radius:999px;overflow:hidden}
  .bar>span{display:block;height:100%;width:0;background:linear-gradient(90deg,var(--pri1),var(--pri2))}
  .msg{margin-top:8px;color:var(--muted);font-size:13px}
  /* Footer note */
  .note{margin-top:14px;color:var(--muted);font-size:12px}
  /* Footer (match landing) */
  footer{background:linear-gradient(90deg,#0f172a,var(--pri2));color:#94a3b8;text-align:center;padding:20px;margin-top:30px;font-size:13px;box-shadow:0 -2px 8px rgba(0,0,0,0.3)}
  footer a{color:#fff;text-decoration:none;font-weight:bold}
</style>
</head>
<body>
<header>
  <a class="logo" href="../../index.html" title="Back to Smarttool Hub">
    <img src="https://img.icons8.com/fluency/48/toolbox.png" alt="Smarttool Hub Logo"/>
    <div>
      <h1>Smarttool Hub</h1>
      <div class="tagline">Powerful, Free, and Instant Tools for Everyone</div>
    </div>
  </a>
  <a class="home" href="../../index.html"><i class="fa fa-home"></i> All Tools</a>
</header>

<div class="container">
  <div class="card">
    <h2 class="title"><i class="fa-solid fa-object-group"></i> Merge Multiple PDFs</h2>
    <p class="subtitle">Select or drop multiple PDFs, reorder them, then merge — everything happens in your browser.</p>

    <div class="actions">
      <label class="btn"><i class="fa fa-file-arrow-up"></i> Select PDF Files
        <input id="fileInput" type="file" accept=".pdf,application/pdf" multiple>
      </label>
      <button id="clearBtn" class="btn secondary"><i class="fa fa-broom"></i> Clear List</button>
      <button id="mergeBtn" class="btn"><i class="fa fa-layer-group"></i> Merge PDFs</button>
      <span class="hint">Tip: You can also drag & drop PDFs below</span>
    </div>

    <div id="dropZone" class="drop">
      <div><i class="fa-solid fa-cloud-arrow-up"></i></div>
      <div>Drag & Drop PDFs here</div>
      <div class="hint">Only .pdf files are accepted</div>
    </div>

    <div id="fileList" class="list" aria-live="polite"></div>

    <div id="progressWrap" class="progress">
      <div class="bar"><span id="progBar"></span></div>
      <div id="progMsg" class="msg">Preparing…</div>
    </div>

    <div class="note"><i class="fa fa-lock"></i> Files never leave your device. Merging uses client-side <code>pdf-lib</code>.</div>
  </div>
</div>

<footer>
  © 2025 Smarttool Hub — Your one-stop for all free online tools. <a href="../../index.html">Back to Home</a>
</footer>

<!-- pdf-lib -->
<script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>

<script>
/* ---------- State ---------- */
let files = []; // [{file:File, id:number}]
let seq = 0;

/* ---------- DOM ---------- */
const input = document.getElementById('fileInput');
const drop = document.getElementById('dropZone');
const list = document.getElementById('fileList');
const clearBtn = document.getElementById('clearBtn');
const mergeBtn = document.getElementById('mergeBtn');
const progressWrap = document.getElementById('progressWrap');
const progBar = document.getElementById('progBar');
const progMsg = document.getElementById('progMsg');

/* ---------- Helpers ---------- */
function addFiles(fileList){
  for(const f of fileList){
    if(!f.name.toLowerCase().endsWith('.pdf')){
      alert('Only PDF files allowed: ' + f.name);
      continue;
    }
    files.push({file:f, id: ++seq});
  }
  render();
}
function render(){
  list.innerHTML = '';
  if(files.length === 0){
    list.innerHTML = '<div class="hint">No files selected yet.</div>';
    return;
  }
  for(const {file,id} of files){
    const row = document.createElement('div');
    row.className = 'item';
    row.innerHTML = `
      <div class="name"><i class="fa-regular fa-file-pdf" style="color:#ef4444"></i>
        <span title="${file.name}">${file.name}</span>
      </div>
      <div class="controls">
        <button class="iconbtn" title="Move up" data-act="up" data-id="${id}"><i class="fa fa-arrow-up"></i></button>
        <button class="iconbtn" title="Move down" data-act="down" data-id="${id}"><i class="fa fa-arrow-down"></i></button>
        <button class="iconbtn" title="Remove" data-act="remove" data-id="${id}"><i class="fa fa-trash"></i></button>
      </div>`;
    list.appendChild(row);
  }
}
function move(id, dir){
  const i = files.findIndex(x=>x.id==id);
  if(i<0) return;
  const j = i + dir;
  if(j<0 || j>=files.length) return;
  [files[i], files[j]] = [files[j], files[i]];
  render();
}
function removeOne(id){
  files = files.filter(x=>x.id!=id);
  render();
}
function uiProgress(pct, msg){
  progressWrap.style.display = 'block';
  progBar.style.width = pct + '%';
  if(msg) progMsg.textContent = msg;
}
function uiResetProgress(){
  progressWrap.style.display = 'none';
  progBar.style.width = '0%';
  progMsg.textContent = 'Preparing…';
}

/* ---------- Events ---------- */
// file input
input.addEventListener('change', (e)=> addFiles(e.target.files));

// drag & drop
;['dragenter','dragover'].forEach(ev=>{
  drop.addEventListener(ev, (e)=>{ e.preventDefault(); drop.classList.add('drag'); });
});
;['dragleave','drop'].forEach(ev=>{
  drop.addEventListener(ev, (e)=>{ e.preventDefault(); drop.classList.remove('drag'); });
});
drop.addEventListener('drop', (e)=>{
  addFiles(e.dataTransfer.files);
});

// list buttons
list.addEventListener('click',(e)=>{
  const btn = e.target.closest('button');
  if(!btn) return;
  const id = btn.getAttribute('data-id');
  const act = btn.getAttribute('data-act');
  if(act==='remove') removeOne(id);
  if(act==='up') move(id,-1);
  if(act==='down') move(id,1);
});

// clear
clearBtn.addEventListener('click', ()=>{
  files = [];
  render();
  uiResetProgress();
});

// merge
mergeBtn.addEventListener('click', async ()=>{
  if(files.length===0){ alert('Please select at least one PDF file.'); return; }

  mergeBtn.disabled = true;
  clearBtn.disabled = true;
  uiProgress(8, 'Creating output…');

  try{
    const outPdf = await PDFLib.PDFDocument.create();
    let skipped = [];
    for(let i=0;i<files.length;i++){
      const {file} = files[i];
      uiProgress(8 + Math.round((i/files.length)*80), 'Adding: ' + file.name);
      try{
        const bytes = await file.arrayBuffer();
        const src = await PDFLib.PDFDocument.load(bytes, { ignoreEncryption:true });
        const total = src.getPageCount();
        for(let p=0;p<total;p++){
          const [copied] = await outPdf.copyPages(src,[p]);
          outPdf.addPage(copied);
        }
      }catch(err){
        console.warn('Skipping file (cannot parse):', file.name, err);
        skipped.push(file.name);
        continue;
      }
    }

    if(outPdf.getPageCount()===0){
      alert('Merging failed: all files were skipped (possibly encrypted/corrupt).');
      return;
    }

    uiProgress(95, 'Finalizing…');
    const outBytes = await outPdf.save({ useObjectStreams:false });
    const blob = new Blob([outBytes], { type:'application/pdf' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url; a.download = 'merged.pdf'; a.click();

    if(skipped.length){
      setTimeout(()=>alert('Skipped files (could not parse):\n' + skipped.join('\n')), 300);
    }
    uiProgress(100, 'Done!');
  }catch(e){
    console.error(e);
    alert('Unexpected error while merging.');
  }finally{
    mergeBtn.disabled = false;
    clearBtn.disabled = false;
    setTimeout(uiResetProgress, 800);
  }
});

// initial render
render();
</script>
</body>
</html>
