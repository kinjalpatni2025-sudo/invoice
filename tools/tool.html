<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>SmartTool Hub — Tool</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    :root{
      --bg:#0f172a; --panel:#1e293b; --muted:#94a3b8; --accent:#6366f1;
    }
    body{margin:0;font-family:Inter, Arial, sans-serif;background:linear-gradient(180deg,#0f172a,#071022);color:#e6eef8}
    header{padding:16px;background:var(--panel);display:flex;align-items:center;justify-content:space-between}
    header a{color:#e6eef8;text-decoration:none;font-weight:600}
    main{max-width:1000px;margin:28px auto;padding:22px;background:rgba(255,255,255,0.02);border-radius:12px}
    h1{margin:0 0 6px 0}
    p{color:var(--muted);margin-top:0}
    .tool-box{margin-top:18px;padding:18px;background:#071024;border:1px solid #22303f;border-radius:10px;min-height:260px}
    label{display:block;margin:10px 0 6px;color:var(--muted);font-size:0.95rem}
    input[type="text"], textarea, select, input[type="number"]{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:#071024;color:inherit}
    input[type="file"]{color:var(--muted)}
    button.primary{background:linear-gradient(90deg,var(--accent),#06b6d4);color:white;padding:10px 14px;border:0;border-radius:8px;cursor:pointer}
    button.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted);padding:8px 12px;border-radius:8px;cursor:pointer}
    .result{margin-top:12px}
    pre{background:#071024;padding:12px;border-radius:8px;overflow:auto;color:#cbd5e1}
    .small{font-size:0.9rem;color:var(--muted)}
    footer{max-width:1000px;margin:18px auto;color:var(--muted);text-align:center}
    a.icon-link{color:var(--muted);text-decoration:none;margin-left:10px}
  </style>
</head>
<body>
  <header>
    <div style="display:flex;align-items:center;gap:12px;">
      <a href="../index.html"><i class="fa-solid fa-arrow-left"></i> Back</a>
      <div class="small">SmartTool Hub</div>
    </div>
    <div class="small">All tools run in your browser • No files uploaded to our servers</div>
  </header>

  <main>
    <h1 id="toolTitle">Loading...</h1>
    <p id="toolDesc"></p>

    <div class="tool-box" id="toolBox">
      Loading tool UI...
    </div>
  </main>

  <footer>
    <div class="small">Tip: open a tool directly with <code>?tool=slug</code> in the URL (for example <code>?tool=pdf-merge</code>).</div>
  </footer>

<script>
/*
  tools object: slug -> {title, description, code}
  'code' contains simple HTML string placeholders or lightweight working UI for many utilities.
  You can expand each tool's code to full functionality later.
*/

const tools = {
  /* PDF tools */
  "image-to-pdf": {
    title: "Image to PDF",
    desc: "Convert one or more images into a single PDF (in-browser).",
    code: `
      <label>Select images (PNG, JPG)</label>
      <input id="imgs" type="file" accept="image/*" multiple />
      <div style="margin-top:12px"><button id="img2pdfBtn" class="primary">Convert to PDF</button></div>
      <div id="img2pdfRes" class="result small"></div>
      <script>
        (function(){
          const btn = document.getElementById('img2pdfBtn');
          btn.onclick = async () => {
            const files = document.getElementById('imgs').files;
            if(!files.length) return alert('Please select at least one image.');
            // Use PDF-LIB if available in the future; here just inform user to download images or implement library.
            document.getElementById('img2pdfRes').innerHTML = 'This demo is a placeholder. For full image→PDF, include pdf-lib and implement merging.';
          };
        })()
      <\/script>`
  },

  "pdf-merge": {
    title: "Merge PDFs",
    desc: "Merge multiple PDF files into one PDF (in-browser, best-effort).",
    code: `
      <label>Select PDF files (order preserved)</label>
      <input id="mergeFiles" type="file" accept="application/pdf" multiple />
      <div style="margin-top:12px"><button id="mergeBtn" class="primary">Merge PDFs</button></div>
      <div id="mergeRes" class="result small"></div>
      <script>
        (function(){
          document.getElementById('mergeBtn').onclick = ()=> {
            document.getElementById('mergeRes').innerText = 'This is a placeholder. To merge PDFs in-browser, include pdf-lib and use its APIs.';
          };
        })()
      <\/script>`
  },

  "pdf-split": {
    title: "Split PDF",
    desc: "Split a PDF into single pages or extract ranges.",
    code: `
      <label>Select PDF</label>
      <input id="splitFile" type="file" accept="application/pdf" />
      <label>Pages to extract (e.g. 1-3,5)</label>
      <input id="splitRanges" type="text" placeholder="1-3,5" />
      <div style="margin-top:12px"><button id="splitBtn" class="primary">Split</button></div>
      <div id="splitRes" class="result small"></div>
      <script>
        document.getElementById('splitBtn').onclick = ()=> {
          document.getElementById('splitRes').innerText = 'Placeholder: include pdf-lib/pdf.js to implement splitting inside the browser.';
        };
      <\/script>`
  },

  "pdf-compress": {
    title: "Compress PDF",
    desc: "Attempt to reduce PDF size by downsampling images (browser-side).",
    code: `<p class="small">In-browser PDF compression is CPU- and memory-heavy. Implement with pdf.js + canvas + pdf-lib for best results. This is a placeholder.</p>`
  },

  "pdf-rotate": {
    title: "Rotate PDF",
    desc: "Rotate PDF pages (90 / 180 / 270 degrees).",
    code: `
      <label>Select PDF</label>
      <input id="rotateFile" type="file" accept="application/pdf" />
      <label>Rotate</label>
      <select id="rotateDeg"><option>90</option><option>180</option><option>270</option></select>
      <div style="margin-top:12px"><button id="rotateBtn" class="primary">Apply Rotation</button></div>
      <div id="rotateRes" class="result small"></div>
      <script>
        document.getElementById('rotateBtn').onclick = ()=> {
          document.getElementById('rotateRes').innerText = 'Placeholder: pdf-lib can set page rotation; include it to perform rotation.';
        };
      <\/script>`
  },

  "pdf-unlock": {
    title: "Unlock PDF",
    desc: "Remove owner password if you know it (limited in-browser).",
    code: `<p class="small">Note: full password removal is limited in-browser. pdf.js can unlock with a known password; full removal may require server-side tooling. This is a placeholder.</p>`
  },

  "pdf-password": {
    title: "Password Protect PDF",
    desc: "Add a basic protection/cover to a PDF (strong encryption not available in simple browser-only flows).",
    code: `<p class="small">True strong PDF encryption requires specialized libraries or server-side processing. This placeholder shows where protection UI would go.</p>`
  },

  "pdf-edit": {
    title: "Edit PDF",
    desc: "Add simple text annotations to PDF pages (placeholder).",
    code: `<p class="small">Use pdf-lib for in-browser editing (drawing text, shapes). This space is a placeholder for editing UI.</p>`
  },

  "pdf-to-image": {
    title: "PDF to Image",
    desc: "Convert PDF pages to PNG/JPG using pdf.js and canvas (placeholder).",
    code: `<p class="small">To convert PDF pages to images implement pdf.js rendering to canvas and export dataURLs. This is a placeholder message.</p>`
  },

  /* IMAGE tools */
  "image-to-png-jpg": {
    title: "Image to PNG / JPG",
    desc: "Convert images between PNG and JPG using canvas.",
    code: `
      <label>Select image</label>
      <input id="imgConv" type="file" accept="image/*" />
      <label>Output format</label>
      <select id="imgFormat"><option value="image/png">PNG</option><option value="image/jpeg">JPG</option></select>
      <div style="margin-top:12px"><button id="imgConvBtn" class="primary">Convert</button></div>
      <div id="imgConvRes" class="result small"></div>
      <script>
        document.getElementById('imgConvBtn').onclick = ()=>{
          const f = document.getElementById('imgConv').files[0];
          if(!f) return alert('Select an image');
          const url = URL.createObjectURL(f);
          const img = new Image();
          img.onload = ()=>{
            const c = document.createElement('canvas'); c.width=img.width; c.height=img.height;
            c.getContext('2d').drawImage(img,0,0);
            const fmt = document.getElementById('imgFormat').value;
            const data = c.toDataURL(fmt,0.92);
            const a = document.createElement('a'); a.href=data; a.download = 'converted.' + (fmt.includes('png')?'png':'jpg'); a.click();
            document.getElementById('imgConvRes').innerText = 'Download started';
            URL.revokeObjectURL(url);
          };
          img.src = url;
        };
      <\/script>`
  },

  "jpg-to-png": {
    title: "JPG to PNG",
    desc: "Convert JPG to PNG (uses same UI as image converter).",
    code: `<p class="small">Use the Image → PNG/JPG tool to convert JPG to PNG.</p>`
  },

  "png-to-jpg": {
    title: "PNG to JPG",
    desc: "Convert PNG to JPG (uses same UI as image converter).",
    code: `<p class="small">Use the Image → PNG/JPG tool to convert PNG to JPG.</p>`
  },

  "image-resize": {
    title: "Resize Image",
    desc: "Resize image by width/height while keeping aspect ratio.",
    code: `
      <label>Select image</label>
      <input id="resizeImg" type="file" accept="image/*" />
      <label>New width (px) — leave blank to auto-calc</label>
      <input id="newW" type="number" placeholder="e.g. 800" />
      <label>New height (px) — leave blank to auto-calc</label>
      <input id="newH" type="number" placeholder="e.g. 600" />
      <div style="margin-top:12px"><button id="resizeBtn" class="primary">Resize</button></div>
      <div id="resizeRes" class="result small"></div>
      <script>
        document.getElementById('resizeBtn').onclick = ()=>{
          const f = document.getElementById('resizeImg').files[0];
          if(!f) return alert('Select an image');
          const url = URL.createObjectURL(f);
          const img = new Image();
          img.onload = ()=>{
            let nw = parseInt(document.getElementById('newW').value) || null;
            let nh = parseInt(document.getElementById('newH').value) || null;
            if(!nw && !nh){ nw = img.width; nh = img.height; }
            if(!nw) nw = Math.round(img.width * (nh / img.height));
            if(!nh) nh = Math.round(img.height * (nw / img.width));
            const c = document.createElement('canvas'); c.width = nw; c.height = nh;
            c.getContext('2d').drawImage(img,0,0,nw,nh);
            const data = c.toDataURL('image/png');
            const a = document.createElement('a'); a.href = data; a.download = 'resized.png'; a.click();
            document.getElementById('resizeRes').innerText = 'Download started';
            URL.revokeObjectURL(url);
          };
          img.src = url;
        };
      <\/script>`
  },

  "image-crop": {
    title: "Crop Image",
    desc: "Crop an image by specifying X, Y, width, height (simple rectangle crop).",
    code: `
      <label>Select image</label>
      <input id="cropImg" type="file" accept="image/*" />
      <label>Crop rectangle (x,y,width,height)</label>
      <input id="cropRect" type="text" placeholder="10,10,200,150" />
      <div style="margin-top:12px"><button id="cropBtn" class="primary">Crop</button></div>
      <div id="cropRes" class="result small"></div>
      <script>
        document.getElementById('cropBtn').onclick = ()=>{
          const f = document.getElementById('cropImg').files[0];
          if(!f) return alert('Select an image');
          const rect = (document.getElementById('cropRect').value || '').split(',').map(s=>parseInt(s.trim()));
          if(rect.length < 4) return alert('Enter 4 numbers');
          const url = URL.createObjectURL(f);
          const img = new Image();
          img.onload = ()=>{
            const c = document.createElement('canvas'); c.width = rect[2]; c.height = rect[3];
            c.getContext('2d').drawImage(img, rect[0], rect[1], rect[2], rect[3], 0, 0, rect[2], rect[3]);
            const data = c.toDataURL('image/png');
            const a = document.createElement('a'); a.href = data; a.download = 'cropped.png'; a.click();
            document.getElementById('cropRes').innerText = 'Download started';
            URL.revokeObjectURL(url);
          };
          img.src = url;
        };
      <\/script>`
  },

  "image-flip-rotate": {
    title: "Flip / Rotate Image",
    desc: "Flip horizontally/vertically or rotate 90/180/270 degrees.",
    code: `
      <label>Select image</label>
      <input id="frImg" type="file" accept="image/*" />
      <label>Operation</label>
      <select id="frOp">
        <option value="flipH">Flip Horizontal</option>
        <option value="flipV">Flip Vertical</option>
        <option value="rot90">Rotate 90</option>
        <option value="rot180">Rotate 180</option>
        <option value="rot270">Rotate 270</option>
      </select>
      <div style="margin-top:12px"><button id="frBtn" class="primary">Apply</button></div>
      <div id="frRes" class="result small"></div>
      <script>
        document.getElementById('frBtn').onclick = ()=>{
          const f = document.getElementById('frImg').files[0];
          if(!f) return alert('Select an image');
          const op = document.getElementById('frOp').value;
          const url = URL.createObjectURL(f);
          const img = new Image();
          img.onload = ()=>{
            let w = img.width, h = img.height;
            let cw = w, ch = h;
            if(op === 'rot90' || op === 'rot270'){ cw = h; ch = w; }
            const c = document.createElement('canvas'); c.width = cw; c.height = ch;
            const ctx = c.getContext('2d');
            ctx.save();
            if(op === 'flipH'){ ctx.translate(w,0); ctx.scale(-1,1); ctx.drawImage(img,0,0); }
            else if(op === 'flipV'){ ctx.translate(0,h); ctx.scale(1,-1); ctx.drawImage(img,0,0); }
            else if(op === 'rot90'){ ctx.translate(cw/2,ch/2); ctx.rotate(90*Math.PI/180); ctx.drawImage(img,-w/2,-h/2); }
            else if(op === 'rot180'){ ctx.translate(cw/2,ch/2); ctx.rotate(180*Math.PI/180); ctx.drawImage(img,-w/2,-h/2); }
            else if(op === 'rot270'){ ctx.translate(cw/2,ch/2); ctx.rotate(270*Math.PI/180); ctx.drawImage(img,-w/2,-h/2); }
            ctx.restore();
            const data = c.toDataURL('image/png'); const a=document.createElement('a'); a.href=data; a.download='out.png'; a.click();
            document.getElementById('frRes').innerText = 'Download started';
            URL.revokeObjectURL(url);
          };
          img.src = url;
        };
      <\/script>`
  },

  "image-watermark": {
    title: "Image Watermark",
    desc: "Add a text watermark to an image (positioned bottom-right).",
    code: `
      <label>Select base image</label>
      <input id="wmImg" type="file" accept="image/*" />
      <label>Watermark text</label>
      <input id="wmText" type="text" placeholder="© SmartTool Hub" />
      <label>Opacity (0.0 to 1.0)</label>
      <input id="wmOpacity" type="number" step="0.1" value="0.4" />
      <div style="margin-top:12px"><button id="wmBtn" class="primary">Apply Watermark</button></div>
      <div id="wmRes" class="result small"></div>
      <script>
        document.getElementById('wmBtn').onclick = ()=>{
          const f = document.getElementById('wmImg').files[0];
          if(!f) return alert('Select an image');
          const txt = document.getElementById('wmText').value || '';
          const op = parseFloat(document.getElementById('wmOpacity').value) || 0.4;
          const url = URL.createObjectURL(f);
          const img = new Image();
          img.onload = ()=>{
            const c = document.createElement('canvas'); c.width = img.width; c.height = img.height;
            const ctx = c.getContext('2d'); ctx.drawImage(img,0,0);
            ctx.globalAlpha = op;
            ctx.font = Math.max(16, Math.round(img.width/25)) + 'px sans-serif';
            ctx.fillStyle = 'white'; ctx.textBaseline = 'bottom';
            const textWidth = ctx.measureText(txt).width;
            ctx.fillText(txt, img.width - textWidth - 20, img.height - 20);
            const data = c.toDataURL('image/png'); const a = document.createElement('a'); a.href = data; a.download = 'watermarked.png'; a.click();
            document.getElementById('wmRes').innerText = 'Download started';
            URL.revokeObjectURL(url);
          };
          img.src = url;
        };
      <\/script>`
  },

  "image-effects": {
    title: "Image Effects",
    desc: "Apply simple filters: grayscale, sepia, invert, blur.",
    code: `
      <label>Select image</label>
      <input id="fxImg" type="file" accept="image/*" />
      <label>Filter</label>
      <select id="fxSel">
        <option value="none">None</option>
        <option value="grayscale">Grayscale</option>
        <option value="sepia">Sepia</option>
        <option value="invert">Invert</option>
        <option value="blur">Blur</option>
      </select>
      <div style="margin-top:12px"><button id="fxBtn" class="primary">Apply Filter</button></div>
      <div id="fxRes" class="result small"></div>
      <script>
        document.getElementById('fxBtn').onclick = ()=>{
          const f = document.getElementById('fxImg').files[0];
          if(!f) return alert('Select image');
          const filter = document.getElementById('fxSel').value;
          const url = URL.createObjectURL(f); const img = new Image();
          img.onload = ()=>{
            const c = document.createElement('canvas'); c.width = img.width; c.height = img.height;
            const ctx = c.getContext('2d');
            ctx.filter = filter==='none' ? 'none' : (filter==='blur' ? 'blur(4px)' : (filter==='grayscale'?'grayscale(1)':filter==='sepia'?'sepia(1)':'invert(1)'));
            ctx.drawImage(img,0,0);
            const data = c.toDataURL('image/png'); const a = document.createElement('a'); a.href = data; a.download = 'effect.png'; a.click();
            document.getElementById('fxRes').innerText = 'Download started';
            URL.revokeObjectURL(url);
          };
          img.src = url;
        };
      <\/script>`
  },

  /* TEXT & URL tools */
  "base64": {
    title: "Base64 Encode / Decode",
    desc: "Encode text to Base64 or decode Base64 to text.",
    code: `
      <label>Input text</label>
      <textarea id="b64in" rows="6"></textarea>
      <div style="margin-top:10px">
        <button id="b64enc" class="primary">Encode</button>
        <button id="b64dec" class="ghost">Decode</button>
      </div>
      <div id="b64out" class="result"></div>
      <script>
        document.getElementById('b64enc').onclick = ()=>{
          try{ const s = document.getElementById('b64in').value || ''; document.getElementById('b64out').innerHTML = '<pre>' + btoa(unescape(encodeURIComponent(s))) + '</pre>'; }
          catch(e){ document.getElementById('b64out').innerText = 'Encoding error'; }
        };
        document.getElementById('b64dec').onclick = ()=>{
          try{ const s = document.getElementById('b64in').value || ''; document.getElementById('b64out').innerHTML = '<pre>' + decodeURIComponent(escape(atob(s))) + '</pre>'; }
          catch(e){ document.getElementById('b64out').innerText = 'Decoding error'; }
        };
      <\/script>`
  },

  "url-encode-decode": {
    title: "URL Encode / Decode",
    desc: "Encode or decode URLs safely.",
    code: `
      <label>Input text or URL</label>
      <input id="urltxt" type="text" />
      <div style="margin-top:10px">
        <button id="urlenc" class="primary">Encode</button>
        <button id="urldec" class="ghost">Decode</button>
      </div>
      <div id="urlout" class="result small"></div>
      <script>
        document.getElementById('urlenc').onclick = ()=> {
          document.getElementById('urlout').innerHTML = '<pre>' + encodeURIComponent(document.getElementById('urltxt').value || '') + '</pre>';
        };
        document.getElementById('urldec').onclick = ()=> {
          try{ document.getElementById('urlout').innerHTML = '<pre>' + decodeURIComponent(document.getElementById('urltxt').value || '') + '</pre>'; } catch(e){ document.getElementById('urlout').innerText = 'Decode error'; }
        };
      <\/script>`
  },

  "case-converter": {
    title: "Case Converter",
    desc: "Convert text to UPPERCASE, lowercase or Title Case.",
    code: `
      <label>Input text</label>
      <textarea id="caseIn" rows="6"></textarea>
      <div style="margin-top:10px">
        <button id="upper" class="primary">UPPERCASE</button>
        <button id="lower" class="ghost">lowercase</button>
        <button id="title" class="ghost">Title Case</button>
      </div>
      <div id="caseOut" class="result small"></div>
      <script>
        document.getElementById('upper').onclick = ()=> document.getElementById('caseOut').innerHTML = '<pre>' + document.getElementById('caseIn').value.toUpperCase() + '</pre>';
        document.getElementById('lower').onclick = ()=> document.getElementById('caseOut').innerHTML = '<pre>' + document.getElementById('caseIn').value.toLowerCase() + '</pre>';
        document.getElementById('title').onclick = ()=> {
          const s = document.getElementById('caseIn').value.toLowerCase().replace(/\\b\\w/g, c=>c.toUpperCase());
          document.getElementById('caseOut').innerHTML = '<pre>' + s + '</pre>';
        };
      <\/script>`
  },

  "word-char-counter": {
    title: "Word & Character Counter",
    desc: "Count words, characters and lines.",
    code: `
      <label>Paste text</label>
      <textarea id="wcIn" rows="8"></textarea>
      <div style="margin-top:10px"><button id="wcBtn" class="primary">Count</button></div>
      <div id="wcOut" class="result small"></div>
      <script>
        document.getElementById('wcBtn').onclick = ()=>{
          const s = document.getElementById('wcIn').value || '';
          const chars = s.length;
          const words = s.trim() ? s.trim().split(/\\s+/).length : 0;
          const lines = s.split(/\\r?\\n/).length;
          document.getElementById('wcOut').innerText = 'Words: ' + words + ' • Characters: ' + chars + ' • Lines: ' + lines;
        };
      <\/script>`
  },

  "online-notepad": {
    title: "Online Notepad",
    desc: "Simple notepad with local auto-save in browser storage.",
    code: `
      <label>Note (saved locally in your browser)</label>
      <textarea id="note" rows="12"></textarea>
      <div style="margin-top:10px"><button id="saveNote" class="primary">Save Now</button> <button id="clearNote" class="ghost">Clear</button></div>
      <div id="noteMsg" class="result small"></div>
      <script>
        const ta = document.getElementById('note');
        ta.value = localStorage.getItem('smarttool_notepad') || '';
        ta.oninput = ()=> localStorage.setItem('smarttool_notepad', ta.value);
        document.getElementById('saveNote').onclick = ()=> { localStorage.setItem('smarttool_notepad', ta.value); document.getElementById('noteMsg').innerText='Saved locally'; };
        document.getElementById('clearNote').onclick = ()=> { if(confirm('Clear note?')){ ta.value=''; localStorage.removeItem('smarttool_notepad'); document.getElementById('noteMsg').innerText='Cleared'; } };
      <\/script>`
  },

  /* DATA tools */
  "json-formatter": {
    title: "JSON Formatter & Validator",
    desc: "Format, validate and prettify JSON.",
    code: `
      <label>Paste JSON</label>
      <textarea id="jsonIn" rows="12"></textarea>
      <div style="margin-top:10px"><button id="fmtBtn" class="primary">Format</button> <button id="minBtn" class="ghost">Minify</button></div>
      <div id="jsonOut" class="result small"></div>
      <script>
        document.getElementById('fmtBtn').onclick = ()=>{
          try{ const obj = JSON.parse(document.getElementById('jsonIn').value); document.getElementById('jsonOut').innerHTML = '<pre>' + JSON.stringify(obj,null,2) + '</pre>'; }
          catch(e){ document.getElementById('jsonOut').innerText = 'Invalid JSON: ' + e.message; }
        };
        document.getElementById('minBtn').onclick = ()=>{
          try{ const obj = JSON.parse(document.getElementById('jsonIn').value); document.getElementById('jsonOut').innerHTML = '<pre>' + JSON.stringify(obj) + '</pre>'; }
          catch(e){ document.getElementById('jsonOut').innerText = 'Invalid JSON'; }
        };
      <\/script>`
  },

  "csv-to-json": {
    title: "CSV to JSON",
    desc: "Convert CSV text to a JSON array (basic CSV without complex quoting).",
    code: `
      <label>Paste CSV (first row = headers)</label>
      <textarea id="csvIn" rows="10"></textarea>
      <div style="margin-top:10px"><button id="csv2json" class="primary">Convert</button></div>
      <div id="csvOut" class="result small"></div>
      <script>
        document.getElementById('csv2json').onclick = ()=>{
          const csv = document.getElementById('csvIn').value.trim();
          if(!csv) return;
          const lines = csv.split(/\\r?\\n/);
          const headers = lines.shift().split(',');
          const out = lines.map(l=>{
            const parts = l.split(',');
            const obj = {}; headers.forEach((h,i)=> obj[h.trim()] = (parts[i]||'').trim()); return obj;
          });
          document.getElementById('csvOut').innerHTML = '<pre>' + JSON.stringify(out,null,2) + '</pre>';
        };
      <\/script>`
  },

  "json-to-csv": {
    title: "JSON to CSV",
    desc: "Convert a JSON array to CSV (best with uniform objects).",
    code: `
      <label>Paste JSON array</label>
      <textarea id="j2cIn" rows="10"></textarea>
      <div style="margin-top:10px"><button id="j2cBtn" class="primary">Convert</button></div>
      <div id="j2cOut" class="result small"></div>
      <script>
        document.getElementById('j2cBtn').onclick = ()=>{
          try{
            const data = JSON.parse(document.getElementById('j2cIn').value);
            if(!Array.isArray(data)) return document.getElementById('j2cOut').innerText = 'Provide a JSON array';
            const keys = Array.from(data.reduce((s,o)=>{ Object.keys(o).forEach(k=>s.add(k)); return s; }, new Set()));
            const rows = [keys.join(',')];
            data.forEach(obj=>{
              rows.push(keys.map(k=> '"' + (obj[k]||'').toString().replace(/"/g,'""') + '"').join(','));
            });
            document.getElementById('j2cOut').innerHTML = '<pre>' + rows.join('\\n') + '</pre>';
          } catch(e){ document.getElementById('j2cOut').innerText = 'Invalid JSON'; }
        };
      <\/script>`
  },

  "csv-to-excel": {
    title: "CSV to Excel",
    desc: "Convert CSV to Excel (.xlsx).",
    code: `<p class="small">Browser-side CSV→Excel requires a library like SheetJS (xlsx). This placeholder indicates where to integrate that library.</p>`
  },

  "excel-to-csv": {
    title: "Excel to CSV",
    desc: "Convert Excel (.xlsx) to CSV.",
    code: `<p class="small">Browser-side Excel parsing requires a library (xlsx). Add SheetJS to enable this conversion in the browser. Placeholder UI.</p>`
  },

  "data-table-viewer": {
    title: "Data Table Viewer",
    desc: "View CSV/JSON tabular data in a table.",
    code: `<p class="small">Paste CSV or JSON in the related tools, then use the table viewer to preview structured data. Placeholder for a table UI.</p>`
  },

  /* QR & COLOR tools */
  "color-picker": {
    title: "Color Picker",
    desc: "Choose a color and copy its HEX code.",
    code: `
      <label>Pick a color</label>
      <input id="cp" type="color" value="#06b6d4" />
      <div style="margin-top:12px"><button id="cpBtn" class="primary">Copy HEX</button></div>
      <div id="cpOut" class="result small"></div>
      <script>
        document.getElementById('cpBtn').onclick = async ()=>{
          const v = document.getElementById('cp').value;
          try{ await navigator.clipboard.writeText(v); document.getElementById('cpOut').innerText = 'Copied ' + v; }
          catch(e){ document.getElementById('cpOut').innerText = 'Copy failed: ' + v; }
        };
      <\/script>`
  },

  "qr-generator": {
    title: "QR Code Generator",
    desc: "Generate a QR code PNG for a URL or text.",
    code: `
      <label>Text or URL</label>
      <input id="qrInput" type="text" placeholder="https://example.com" />
      <div style="margin-top:12px"><button id="qrBtn" class="primary">Generate QR</button></div>
      <div id="qrOut" class="result small"></div>
      <script>
        // Lightweight QR generation using a small library is recommended (qrcode). If not present, show placeholder.
        document.getElementById('qrBtn').onclick = ()=>{
          document.getElementById('qrOut').innerText = 'To generate QR images include a QR library (e.g., https://cdn.jsdelivr.net/npm/qrcode). Placeholder shown.';
        };
      <\/script>`
  },

  "qr-scanner": {
    title: "QR Code Scanner",
    desc: "Scan QR codes using a webcam or image upload (requires decoding library).",
    code: `<p class="small">QR scanning requires a decoder library (e.g., jsQR). Integrate jsQR or a similar library to enable scanning. This is a placeholder UI.</p>`
  }
}; // end tools map

// read query param ?tool=
const params = new URLSearchParams(window.location.search);
const slug = params.get('tool');

// render selected tool or show "not found"
const titleEl = document.getElementById('toolTitle');
const descEl = document.getElementById('toolDesc');
const boxEl = document.getElementById('toolBox');

if(slug && tools[slug]){
  titleEl.textContent = tools[slug].title;
  descEl.textContent = tools[slug].desc;
  boxEl.innerHTML = tools[slug].code;
} else if(slug){
  titleEl.textContent = 'Tool Not Found';
  descEl.textContent = '';
  boxEl.innerHTML = '<p class="small">The requested tool slug is invalid or not available. Check the slug and try again.</p>';
} else {
  titleEl.textContent = 'Tool Not Selected';
  descEl.textContent = 'Open a tool from the homepage or append ?tool=slug to this page URL.';
  boxEl.innerHTML = '<p class="small">Example: <code>tools/tool.html?tool=pdf-merge</code></p>';
}

</script>
</body>
</html>
