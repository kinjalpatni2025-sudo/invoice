<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Split PDF Pages â€” Smarttool Hub</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
<style>
body{font-family:Arial,sans-serif;background:#121826;color:#fff;margin:0;padding:0}
header{background:linear-gradient(90deg,#6366f1,#0ea5e9);padding:15px;text-align:center}
h1{margin:0;font-size:1.4rem}
.container{max-width:1100px;margin:20px auto;padding:20px}
.btn{display:inline-flex;align-items:center;gap:8px;border:none;padding:10px 14px;border-radius:10px;background:#6366f1;color:#fff;font-weight:600;cursor:pointer}
#fileInput{display:none}
.drop{border:2px dashed #0ea5e9;border-radius:12px;padding:28px;text-align:center;margin:12px 0}
.drop.drag{border-color:#fff;background:#0b1220}
.pages{display:grid;grid-template-columns:repeat(auto-fill,120px);gap:12px;margin-top:20px}
.page-thumb{border:2px solid transparent;border-radius:8px;cursor:pointer;background:#0b1220}
.page-thumb img{width:100%;display:block}
.page-thumb.selected{border-color:#0ea5e9}
</style>
</head>
<body>
<header>
  <h1><i class="fa fa-scissors"></i> Split PDF Pages</h1>
</header>

<div class="container">
  <label class="btn">
    <i class="fa fa-file-arrow-up"></i> Select PDF
    <input id="fileInput" type="file" accept=".pdf,application/pdf">
  </label>

  <div id="dropZone" class="drop">
    <i class="fa fa-cloud-arrow-up"></i> Drag & Drop PDF here
  </div>

  <div id="pages" class="pages"></div>

  <button id="exportBtn" class="btn" style="margin-top:15px;display:none">
    <i class="fa fa-download"></i> Export Selected Pages
  </button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
<script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>
<script>
let pdfDoc = null, selectedPages = [], fileBytes = null;

// File select
document.getElementById('fileInput').addEventListener('change', e => {
  if(e.target.files.length) loadPDF(e.target.files[0]);
});

// Drag & Drop
const dropZone = document.getElementById('dropZone');
['dragover','dragenter'].forEach(ev => dropZone.addEventListener(ev, e => {e.preventDefault();dropZone.classList.add('drag');}));
['dragleave','drop'].forEach(ev => dropZone.addEventListener(ev, e => {e.preventDefault();dropZone.classList.remove('drag');}));
dropZone.addEventListener('drop', e => {
  if(e.dataTransfer.files.length) loadPDF(e.dataTransfer.files[0]);
});

// Load PDF and show pages
async function loadPDF(file){
  if(!file.name.toLowerCase().endsWith('.pdf')){alert('Only PDFs allowed');return;}
  fileBytes = await file.arrayBuffer();
  const loadingTask = pdfjsLib.getDocument({data:fileBytes});
  pdfDoc = await loadingTask.promise;
  const pagesDiv = document.getElementById('pages');
  pagesDiv.innerHTML = '';
  selectedPages = [];

  for(let p=1;p<=pdfDoc.numPages;p++){
    const page = await pdfDoc.getPage(p);
    const viewport = page.getViewport({scale:0.3});
    const canvas = document.createElement('canvas');
    const ctx = canvas.getContext('2d');
    canvas.height = viewport.height;
    canvas.width = viewport.width;
    await page.render({canvasContext:ctx,viewport}).promise;

    const thumb = document.createElement('div');
    thumb.className = 'page-thumb';
    thumb.innerHTML = `<img src="${canvas.toDataURL()}"><div style="text-align:center;font-size:12px;color:#ccc">${p}</div>`;
    thumb.addEventListener('click',()=>{
      thumb.classList.toggle('selected');
      if(selectedPages.includes(p)){
        selectedPages = selectedPages.filter(n => n !== p);
      } else {
        selectedPages.push(p);
      }
      document.getElementById('exportBtn').style.display = selectedPages.length ? 'inline-flex' : 'none';
    });
    pagesDiv.appendChild(thumb);
  }
}

// Export selected pages
document.getElementById('exportBtn').addEventListener('click', async ()=>{
  if(!selectedPages.length) return alert("No pages selected!");
  const srcPdf = await PDFLib.PDFDocument.load(fileBytes);
  const newPdf = await PDFLib.PDFDocument.create();
  for(const p of selectedPages){
    const [copied] = await newPdf.copyPages(srcPdf,[p-1]);
    newPdf.addPage(copied);
  }
  const bytes = await newPdf.save();
  const blob = new Blob([bytes], {type:'application/pdf'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'split.pdf';
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
});
</script>
</body>
</html>
