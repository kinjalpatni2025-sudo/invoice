<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Image → PDF Converter — Smarttool Hub</title>
<meta name="description" content="Convert multiple PNG/JPG images into a PDF — maintain sharp quality, rotate, multiple per page, per-image or same text. Free & client-side.">
<link rel="icon" type="image/png" href="https://img.icons8.com/fluency/48/toolbox.png">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
  body{margin:0;font-family:Arial,Helvetica,sans-serif;background:#121826;color:#fff}
  header{background:linear-gradient(90deg,#6366f1,#0ea5e9);padding:14px;text-align:center;box-shadow:0 4px 12px rgba(0,0,0,0.4)}
  header h1{margin:0;font-size:1.5rem;color:#fff;display:inline-flex;gap:10px;align-items:center}
  header p{margin:6px 0 0;color:#e0f2fe;font-size:0.95rem}
  .container{max-width:980px;margin:20px auto;padding:18px;background:#1e293b;border-radius:10px}
  .back-home{display:inline-block;padding:8px 12px;background:#0ea5e9;color:#022;border-radius:6px;text-decoration:none;font-weight:600;margin-bottom:10px}
  .drop{border:2px dashed rgba(255,255,255,0.12);padding:18px;text-align:center;border-radius:8px;background:rgba(255,255,255,0.02)}
  input[type=file]{display:none}
  .btn{background:linear-gradient(90deg,#0ea5a5,#60a5fa);padding:8px 12px;color:#022;font-weight:700;border:none;border-radius:8px;cursor:pointer}
  .controls{margin-top:14px;display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px}
  label{display:block;margin-bottom:6px;color:#94a3b8;font-size:0.9rem}
  select,input[type=color],input[type=text],input[type=number]{width:100%;padding:8px;border-radius:6px;border:none;background:#0f1724;color:#fff}
  .preview{display:flex;flex-wrap:wrap;gap:12px;margin-top:14px;justify-content:center}
  .preview-item{position:relative;border-radius:8px;background:#0b1220;padding:8px;display:flex;flex-direction:column;align-items:center}
  .preview-item img{max-width:160px;max-height:160px;object-fit:contain;border-radius:6px;transform-origin:center center}
  .btn-row{display:flex;gap:8px;margin-top:8px}
  .icon-btn{background:rgba(0,0,0,0.45);border:none;color:#fff;border-radius:6px;padding:6px 8px;cursor:pointer;font-size:14px}
  .icon-btn:hover{background:rgba(14,165,233,0.12)}
  .delete-btn{background:rgba(255,0,0,0.85)}
</style>
</head>
<body>
<header>
  <h1><i class="fa-solid fa-file-arrow-down"></i> Image → PDF Converter</h1>
  <p>Sharp quality • Rotate • Multiple per page • Global / Per-image text</p>
</header>

<div class="container">
  <a class="back-home" href="../../index.html"><i class="fa fa-arrow-left"></i> Back to Home</a>

  <div class="drop" id="drop">
    <p>Drag & drop images here or</p>
    <button class="btn" id="pick">Select Images</button>
    <input type="file" id="files" accept="image/*" multiple>
  </div>

  <div class="controls">
    <div>
      <label>Images per page</label>
      <select id="layout">
        <option value="1">1 × 1</option>
        <option value="4">2 × 2</option>
        <option value="9">3 × 3</option>
      </select>
    </div>
    <div>
      <label>Page background</label>
      <input type="color" id="bgColor" value="#ffffff">
    </div>
    <div>
      <label>Global text</label>
      <input type="text" id="globalText" placeholder="Same text on all pages">
    </div>
    <div>
      <label>Text color & size</label>
      <div style="display:flex;gap:6px">
        <input type="color" id="textColor" value="#000000">
        <input type="number" id="fontSize" value="12" min="6" style="width:70px">
      </div>
    </div>
    <div>
      <label><input type="checkbox" id="useGlobal" checked> Use global text (uncheck for per-image)</label>
    </div>
  </div>

  <div class="preview" id="preview"></div>
  <button class="btn" id="generate" style="margin-top:14px">Convert to PDF</button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
const { jsPDF } = window.jspdf;
let images = [];
const filesEl = document.getElementById('files');
document.getElementById('pick').onclick = () => filesEl.click();
filesEl.onchange = e => addFiles(e.target.files);
['dragenter','dragover'].forEach(ev=>drop.addEventListener(ev,e=>{e.preventDefault();}));
drop.ondrop = e => {e.preventDefault();addFiles(e.dataTransfer.files);};

function addFiles(fileList){
  [...fileList].forEach(file=>{
    if(file.type.startsWith('image/')){
      const reader = new FileReader();
      reader.onload = ev => {
        images.push({src:ev.target.result,rotation:0,text:''});
        render();
      };
      reader.readAsDataURL(file);
    }
  });
}

function render(){
  const preview=document.getElementById('preview');
  preview.innerHTML='';
  images.forEach((imgObj,idx)=>{
    const wrap=document.createElement('div');
    wrap.className='preview-item';
    const img=document.createElement('img');
    img.src=imgObj.src;
    img.style.transform=`rotate(${imgObj.rotation}deg)`;
    const btns=document.createElement('div');
    btns.className='btn-row';
    const rot=document.createElement('button');
    rot.className='icon-btn'; rot.textContent='⟳';
    rot.onclick=()=>{imgObj.rotation=(imgObj.rotation+90)%360;render();};
    const del=document.createElement('button');
    del.className='icon-btn delete-btn'; del.textContent='×';
    del.onclick=()=>{images.splice(idx,1);render();};
    btns.append(rot,del);
    if(!document.getElementById('useGlobal').checked){
      const ti=document.createElement('input');
      ti.type='text'; ti.value=imgObj.text; ti.placeholder='Per-image text';
      ti.oninput=e=>imgObj.text=e.target.value;
      wrap.append(img,btns,ti);
    }else{
      wrap.append(img,btns);
    }
    preview.append(wrap);
  });
}

async function generatePDF(){
  if(images.length===0){alert('Select images first');return;}
  const perPage=parseInt(document.getElementById('layout').value);
  const grid=Math.sqrt(perPage);
  const pdf=new jsPDF();
  const pageW=pdf.internal.pageSize.getWidth();
  const pageH=pdf.internal.pageSize.getHeight();
  const cellW=pageW/grid, cellH=pageH/grid;
  let batch=[];
  for(let i=0;i<images.length;i++){
    batch.push(images[i]);
    if(batch.length===perPage || i===images.length-1){
      pdf.setFillColor(document.getElementById('bgColor').value);
      pdf.rect(0,0,pageW,pageH,'F');
      for(let j=0;j<batch.length;j++){
        const imgObj=batch[j];
        const col=j%grid, row=Math.floor(j/grid);
        const x=col*cellW, y=row*cellH;
        const fullData=await getRotatedImage(imgObj);
        const props=pdf.getImageProperties(fullData);
        let scale=Math.min(cellW/props.width, cellH/props.height);
        const dw=props.width*scale, dh=props.height*scale;
        pdf.addImage(fullData,'JPEG',x+(cellW-dw)/2,y+(cellH-dh)/2,dw,dh,undefined,'NONE',1.0);
        if(!document.getElementById('useGlobal').checked && imgObj.text){
          pdf.setFontSize(10);
          pdf.setTextColor(document.getElementById('textColor').value);
          pdf.text(imgObj.text,x+cellW/2,y+cellH-6,{align:'center'});
        }
      }
      if(document.getElementById('useGlobal').checked && document.getElementById('globalText').value){
        pdf.setFontSize(parseInt(document.getElementById('fontSize').value));
        pdf.setTextColor(document.getElementById('textColor').value);
        pdf.text(document.getElementById('globalText').value,pageW/2,pageH-10,{align:'center'});
      }
      if(i<images.length-1) pdf.addPage();
      batch=[];
    }
  }
  pdf.save('images.pdf');
}

function getRotatedImage(imgObj){
  return new Promise(res=>{
    const img=new Image();
    img.onload=()=>{
      const cvs=document.createElement('canvas');
      const ctx=cvs.getContext('2d');
      if(imgObj.rotation===90 || imgObj.rotation===270){
        cvs.width=img.height; cvs.height=img.width;
      } else { cvs.width=img.width; cvs.height=img.height; }
      ctx.translate(cvs.width/2,cvs.height/2);
      ctx.rotate(imgObj.rotation*Math.PI/180);
      ctx.drawImage(img,-img.width/2,-img.height/2);
      res(cvs.toDataURL('image/jpeg',1.0)); // full quality
    };
    img.src=imgObj.src;
  });
}

document.getElementById('generate').onclick=generatePDF;
document.getElementById('useGlobal').onchange=render;
</script>
</body>
</html>
